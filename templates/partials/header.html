{% set current_path = "" %}
{% if page is defined %}
{% set current_path = page.path %}
{% elif section is defined %}
{% set current_path = section.path %}
{% endif %}
{% set current_lang = lang | default(value=config.default_language) %}

<header class="sticky top-0 w-full z-10">
  <nav class="bg-neutral-950">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="flex items-center justify-between h-16 border-b-1 border-neutral-700 text-neutral-200">
        <!-- LEFT: Brand/Home & Menu -->
        <div class="flex items-center space-x-6">
          <a href="{% if current_lang == 'es' %}/es/{% else %}/{% endif %}"
            class="p-2 hover:bg-neutral-700 hover:text-neutral-50 rounded-md transition ease-in-out duration-250"
            aria-label="{{ res.aria_to_homepage }}">
            <svg class="h-6 w-6 text-neutral-200 fill-none" xmlns="http://www.w3.org/2000/svg" fill="none"
              viewBox="0 0 24 24" stroke-width="2" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round"
                d="m2.25 12 8.954-8.955c.44-.439 1.152-.439 1.591 0L21.75 12M4.5 9.75v10.125c0 .621.504 1.125 1.125 1.125H9.75v-4.875c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125V21h4.125c.621 0 1.125-.504 1.125-1.125V9.75M8.25 21h8.25" />
            </svg>
          </a>

          <div class="flex items-center space-x-2 border-l border-neutral-700 pl-4">
            {% if config.extra.menu_pages %}
            {% for entry in config.extra.menu_pages %}
            <a class="px-3 py-2 rounded-md font-medium hover:bg-neutral-700 hover:text-neutral-50 transition ease-in-out duration-250 {% if entry.url == current_path %} bg-neutral-800 {% endif %}"
              href="{{ get_url(path=entry.url) }}" title="{{ entry.title }}">
              {{ entry.title }}
            </a>
            {% endfor %}
            {% endif %}
          </div>
        </div>

        <!-- RIGHT: Lang Switch, Search, Theme -->
        <div class="flex items-center space-x-2">
          <!-- Language Toggle (to the left of search) -->
          <a href="{% if current_lang == 'en' %}/es/{% else %}/{% endif %}"
            class="font-bold px-3 py-2 hover:bg-neutral-700 hover:text-neutral-50 rounded-md transition ease-in-out duration-250">
            {% if current_lang == 'en' %}ES{% else %}EN{% endif %}
          </a>

          <!-- Search Icon -->
          {% if config.build_search_index %}
          <a href="{% if current_lang == 'es' %}/es/pages/search/{% else %}/pages/search/{% endif %}"
            aria-label="{{ res.aria_search }}" title="{{ res.search_title }}"
            class="flex items-center justify-center cursor-pointer p-2 rounded-full text-neutral-200 hover:text-neutral-50 hover:bg-neutral-700 focus:outline-none focus:text-neutral-700 focus:bg-neutral-200 transition ease-in-out duration-250">
            <svg class="h-6 w-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
              stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round"
                d="m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607Z" />
            </svg>
          </a>
          {% endif %}

          <!-- Theme Toggle -->
          {% include "partials/toggle-theme.html" %}
        </div>
      </div>
    </div>
  </nav>
</header>